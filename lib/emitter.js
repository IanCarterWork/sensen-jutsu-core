/**
 * Type
 */
/**
 * Sensen Event Emitter Response
 */
export function EmitterResponse(type, emit) {
    return { type, emit };
}
/**
 * Sensen Event Emitter
 */
export class SensenEmitter {
    constructor() {
        this.entries = {};
        this.listener = [];
        this.dispatcher = [];
    }
    /**
     * Listener
     */
    listen(type, callback) {
        if (this.listener.indexOf(type) == -1) {
            this.listener[this.listener.length] = type;
        }
        if (typeof type == 'string' && typeof callback == 'function') {
            this.entries[type] = this.entries[type] || [];
            this.entries[type].push(callback);
        }
        return this;
    }
    /**
     * Dispatcher
     */
    dispatch(type, args, resolve, reject) {
        if (this.dispatcher.indexOf(type) == -1) {
            this.dispatcher[this.dispatcher.length] = type;
        }
        if (typeof type == 'string') {
            if (type in this.entries) {
                if (this.entries[type] instanceof Array) {
                    this.entries[type].map((entry) => {
                        if (entry instanceof Function) {
                            this.returned = SensenEmitter.resolveDispatcher({
                                instance: this,
                                type,
                                callback: entry,
                                args,
                                resolve,
                                reject,
                            });
                        }
                    });
                }
            }
        }
        return this;
    }
    static resolveDispatcher({ instance, type, args, callback, resolve, reject, }) {
        const $args = {
            emit: args,
            type,
        };
        const applied = callback.apply(instance, [$args]);
        /**
         * Promise
         */
        if (applied instanceof Promise) {
            return applied.then(response => {
                if (typeof resolve == 'function') {
                    resolve(EmitterResponse(type, response));
                }
            }).catch(err => {
                if (typeof reject == 'function') {
                    reject(err);
                }
            });
        }
        else if (typeof applied == 'boolean') {
            return applied;
        }
        else {
            return this;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1pdHRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL2NvcmUvZW1pdHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQTs7R0FFRztBQWdESDs7R0FFRztBQUNILE1BQU0sVUFBVSxlQUFlLENBQUksSUFBWSxFQUFFLElBQVM7SUFFdEQsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQTtBQUV6QixDQUFDO0FBTUQ7O0dBRUc7QUFDRixNQUFNLE9BQU8sYUFBYTtJQWlCdkI7UUFFSSxJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUVsQixJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztRQUVuQixJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztJQUV6QixDQUFDO0lBTUQ7O09BRUc7SUFDSCxNQUFNLENBQUksSUFBd0IsRUFBRSxRQUFtQztRQUVuRSxJQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFDO1lBRWpDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUM7U0FFOUM7UUFFRCxJQUFHLE9BQU8sSUFBSSxJQUFJLFFBQVEsSUFBSSxPQUFPLFFBQVEsSUFBSSxVQUFVLEVBQUM7WUFFeEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFFLEVBQUUsQ0FBQztZQUU1QyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUVyQztRQUVELE9BQU8sSUFBSSxDQUFDO0lBRWhCLENBQUM7SUFNRDs7T0FFRztJQUNILFFBQVEsQ0FFSixJQUF3QixFQUV4QixJQUFTLEVBRVQsT0FBbUMsRUFFbkMsTUFBcUQ7UUFLckQsSUFBRyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBQztZQUVuQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDO1NBRWxEO1FBR0QsSUFBRyxPQUFPLElBQUksSUFBSSxRQUFRLEVBQUM7WUFFdkIsSUFBRyxJQUFJLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBQztnQkFFcEIsSUFBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxZQUFZLEtBQUssRUFBQztvQkFFbkMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUMsRUFBRTt3QkFFNUIsSUFBRyxLQUFLLFlBQVksUUFBUSxFQUFDOzRCQUV6QixJQUFJLENBQUMsUUFBUSxHQUFHLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBSTtnQ0FFL0MsUUFBUSxFQUFHLElBQUk7Z0NBRWYsSUFBSTtnQ0FFSixRQUFRLEVBQUUsS0FBSztnQ0FFZixJQUFJO2dDQUVKLE9BQU87Z0NBRVAsTUFBTTs2QkFFVCxDQUFDLENBQUE7eUJBRUw7b0JBRUwsQ0FBQyxDQUFDLENBQUM7aUJBRU47YUFFSjtTQUVKO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFFaEIsQ0FBQztJQU1ELE1BQU0sQ0FBQyxpQkFBaUIsQ0FBSSxFQUV4QixRQUFRLEVBRVIsSUFBSSxFQUVKLElBQUksRUFFSixRQUFRLEVBRVIsT0FBTyxFQUVQLE1BQU0sR0FFbUI7UUFFekIsTUFBTSxLQUFLLEdBQStCO1lBRXRDLElBQUksRUFBRSxJQUFJO1lBRVYsSUFBSTtTQUVQLENBQUE7UUFFRCxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFHbEQ7O1dBRUc7UUFDSCxJQUFHLE9BQU8sWUFBWSxPQUFPLEVBQUM7WUFFMUIsT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQSxFQUFFO2dCQUUxQixJQUFHLE9BQU8sT0FBTyxJQUFJLFVBQVUsRUFBQztvQkFFNUIsT0FBTyxDQUFFLGVBQWUsQ0FBSSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUUsQ0FBQTtpQkFFaEQ7WUFFTCxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFBLEVBQUU7Z0JBRVYsSUFBRyxPQUFPLE1BQU0sSUFBSSxVQUFVLEVBQUM7b0JBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO2lCQUFFO1lBRWxELENBQUMsQ0FBQyxDQUFDO1NBR047YUFFSSxJQUFHLE9BQU8sT0FBTyxJQUFJLFNBQVMsRUFBQztZQUVoQyxPQUFPLE9BQU8sQ0FBQztTQUVsQjthQUVHO1lBRUEsT0FBTyxJQUFJLENBQUM7U0FFZjtJQUVMLENBQUM7Q0FNSiIsInNvdXJjZXNDb250ZW50IjpbIlxuXG4vKipcbiAqIFR5cGVcbiAqL1xuXG5leHBvcnQgdHlwZSBTZW5zZW5FbWl0dGVyVHlwZSA9IHN0cmluZ1xuXG5leHBvcnQgdHlwZSBTZW5zZW5FbWl0dGVyQXJndW1lbnRzPFQ+ID0ge1xuICAgIFxuICAgIGVtaXQ6IFQ7XG4gICAgXG4gICAgdHlwZSA6IHN0cmluZztcbiAgICBcbn1cblxuZXhwb3J0IHR5cGUgU2Vuc2VuRW1pdHRlckNhbGxiYWNrPFQ+ID0gKChhcmc6IFNlbnNlbkVtaXR0ZXJBcmd1bWVudHM8VD4pID0+IFByb21pc2U8IFQgfCBTZW5zZW5FbWl0dGVyQXJndW1lbnRzPFQ+ID4gfCBib29sZWFuIHwgdm9pZClcblxuZXhwb3J0IHR5cGUgU2Vuc2VuRW1pdHRlckVycm9yID0ge1xuICAgIGNvZGU6IG51bWJlcjtcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCB0eXBlIFNlbnNlbkVtaXR0ZXJFcnJvckNhbGxiYWNrID0gKChhcmc6IFNlbnNlbkVtaXR0ZXJFcnJvcikgPT4gdm9pZClcblxuZXhwb3J0IHR5cGUgU2Vuc2VuRW1pdHRlckVudHJpZXMgPSB7XG5cbiAgICBbSzogU2Vuc2VuRW1pdHRlclR5cGVdIDogU2Vuc2VuRW1pdHRlckNhbGxiYWNrPGFueT5bXSBcblxufVxuXG5leHBvcnQgdHlwZSBFbWl0dGVyRGlzcGF0Y2hlclByb3BzPFQ+ID0ge1xuICAgICAgICBcbiAgICBpbnN0YW5jZSA6IFNlbnNlbkVtaXR0ZXIsIFxuICAgIFxuICAgIHR5cGUgOiBTZW5zZW5FbWl0dGVyVHlwZSwgXG4gICAgXG4gICAgYXJnczogYW55LFxuICAgIFxuICAgIGNhbGxiYWNrOiBTZW5zZW5FbWl0dGVyQ2FsbGJhY2s8VD4sXG4gICAgXG4gICAgcmVzb2x2ZT8gOiBTZW5zZW5FbWl0dGVyQ2FsbGJhY2s8VD4sXG4gICAgXG4gICAgcmVqZWN0PyA6IChlcnIgOiBTZW5zZW5FbWl0dGVyRXJyb3JDYWxsYmFjayApID0+IHZvaWQsXG5cbn1cblxuXG5cblxuXG5cbi8qKlxuICogU2Vuc2VuIEV2ZW50IEVtaXR0ZXIgUmVzcG9uc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIEVtaXR0ZXJSZXNwb25zZTxUPih0eXBlOiBzdHJpbmcsIGVtaXQ6IGFueSkgOiBTZW5zZW5FbWl0dGVyQXJndW1lbnRzPFQ+e1xuXG4gICAgcmV0dXJuIHsgdHlwZSwgZW1pdCB9XG4gICAgXG59XG5cblxuXG5cblxuLyoqXG4gKiBTZW5zZW4gRXZlbnQgRW1pdHRlclxuICovXG4gZXhwb3J0IGNsYXNzIFNlbnNlbkVtaXR0ZXJ7XG5cblxuICAgIGVudHJpZXM6IFNlbnNlbkVtaXR0ZXJFbnRyaWVzXG5cbiAgICBsaXN0ZW5lcjogU2Vuc2VuRW1pdHRlclR5cGVbXVxuXG4gICAgZGlzcGF0Y2hlcjogU2Vuc2VuRW1pdHRlclR5cGVbXVxuXG5cbiAgICByZXR1cm5lZD86IGFueVxuICAgICBcblxuXG5cbiAgICBcblxuICAgIGNvbnN0cnVjdG9yKCl7XG5cbiAgICAgICAgdGhpcy5lbnRyaWVzID0ge307XG5cbiAgICAgICAgdGhpcy5saXN0ZW5lciA9IFtdO1xuXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlciA9IFtdO1xuICAgICAgICAgICAgXG4gICAgfVxuXG5cblxuXG5cbiAgICAvKipcbiAgICAgKiBMaXN0ZW5lclxuICAgICAqL1xuICAgIGxpc3RlbjxUPih0eXBlIDogU2Vuc2VuRW1pdHRlclR5cGUsIGNhbGxiYWNrIDogU2Vuc2VuRW1pdHRlckNhbGxiYWNrPFQ+KXtcblxuICAgICAgICBpZih0aGlzLmxpc3RlbmVyLmluZGV4T2YodHlwZSkgPT0gLTEpe1xuXG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyW3RoaXMubGlzdGVuZXIubGVuZ3RoXSA9IHR5cGU7XG5cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYodHlwZW9mIHR5cGUgPT0gJ3N0cmluZycgJiYgdHlwZW9mIGNhbGxiYWNrID09ICdmdW5jdGlvbicpe1xuXG4gICAgICAgICAgICB0aGlzLmVudHJpZXNbdHlwZV0gPSB0aGlzLmVudHJpZXNbdHlwZV18fFtdO1xuXG4gICAgICAgICAgICB0aGlzLmVudHJpZXNbdHlwZV0ucHVzaChjYWxsYmFjayk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICBcbiAgICB9XG5cblxuXG5cblxuICAgIC8qKlxuICAgICAqIERpc3BhdGNoZXJcbiAgICAgKi9cbiAgICBkaXNwYXRjaDxUPihcbiAgICAgICAgXG4gICAgICAgIHR5cGUgOiBTZW5zZW5FbWl0dGVyVHlwZSxcbiAgICAgICAgXG4gICAgICAgIGFyZ3MgOiB7fSwgXG4gICAgICAgIFxuICAgICAgICByZXNvbHZlPyA6IFNlbnNlbkVtaXR0ZXJDYWxsYmFjazxUPixcbiAgICAgICAgXG4gICAgICAgIHJlamVjdD8gOiAoZXJyIDogU2Vuc2VuRW1pdHRlckVycm9yQ2FsbGJhY2sgKSA9PiB2b2lkXG5cbiAgICApe1xuICAgICAgICBcblxuICAgICAgICBpZih0aGlzLmRpc3BhdGNoZXIuaW5kZXhPZih0eXBlKSA9PSAtMSl7XG5cbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hlclt0aGlzLmRpc3BhdGNoZXIubGVuZ3RoXSA9IHR5cGU7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIGlmKHR5cGVvZiB0eXBlID09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYodHlwZSBpbiB0aGlzLmVudHJpZXMpe1xuXG4gICAgICAgICAgICAgICAgaWYodGhpcy5lbnRyaWVzW3R5cGVdIGluc3RhbmNlb2YgQXJyYXkpe1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW50cmllc1t0eXBlXS5tYXAoKGVudHJ5KT0+e1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihlbnRyeSBpbnN0YW5jZW9mIEZ1bmN0aW9uKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmV0dXJuZWQgPSBTZW5zZW5FbWl0dGVyLnJlc29sdmVEaXNwYXRjaGVyPFQ+KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlIDogdGhpcywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBlbnRyeSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICB9XG5cblxuXG5cblxuICAgIHN0YXRpYyByZXNvbHZlRGlzcGF0Y2hlcjxUPih7XG4gICAgICAgIFxuICAgICAgICBpbnN0YW5jZSwgXG4gICAgICAgIFxuICAgICAgICB0eXBlLCBcbiAgICAgICAgXG4gICAgICAgIGFyZ3MsXG4gICAgICAgIFxuICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgXG4gICAgICAgIHJlc29sdmUsXG4gICAgICAgIFxuICAgICAgICByZWplY3QsXG5cbiAgICB9IDogRW1pdHRlckRpc3BhdGNoZXJQcm9wczxUPil7XG5cbiAgICAgICAgY29uc3QgJGFyZ3MgOiBTZW5zZW5FbWl0dGVyQXJndW1lbnRzPFQ+ID0ge1xuXG4gICAgICAgICAgICBlbWl0OiBhcmdzLFxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0eXBlLFxuXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhcHBsaWVkID0gY2FsbGJhY2suYXBwbHkoaW5zdGFuY2UsIFskYXJnc10pO1xuXG4gICAgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcm9taXNlXG4gICAgICAgICAqL1xuICAgICAgICBpZihhcHBsaWVkIGluc3RhbmNlb2YgUHJvbWlzZSl7XG5cbiAgICAgICAgICAgIHJldHVybiBhcHBsaWVkLnRoZW4ocmVzcG9uc2U9PntcblxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiByZXNvbHZlID09ICdmdW5jdGlvbicpeyBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoIEVtaXR0ZXJSZXNwb25zZTxUPih0eXBlLCByZXNwb25zZSkgKSBcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyPT57XG5cbiAgICAgICAgICAgICAgICBpZih0eXBlb2YgcmVqZWN0ID09ICdmdW5jdGlvbicpeyByZWplY3QoZXJyKSB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIGVsc2UgaWYodHlwZW9mIGFwcGxpZWQgPT0gJ2Jvb2xlYW4nKXtcblxuICAgICAgICAgICAgcmV0dXJuIGFwcGxpZWQ7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIGVsc2V7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgXG4gICAgXG5cbiAgICBcbn1cbiJdfQ==