/**
 * Type
 */
/**
 * Sensen Event Emitter Response
 */
export function EmitterResponse(type, emit) {
    return { type, emit };
}
/**
 * Sensen Event Emitter
 */
export class SensenEmitter {
    constructor() {
        this.entries = {};
        this.listener = [];
        this.dispatcher = [];
    }
    /**
     * Listener
     */
    listen(type, callback) {
        if (this.listener.indexOf(type) == -1) {
            this.listener[this.listener.length] = type;
        }
        if (typeof type == 'string' && typeof callback == 'function') {
            this.entries[type] = this.entries[type] || [];
            this.entries[type].push(callback);
        }
        return this;
    }
    /**
     * Dispatcher
     */
    dispatch(type, args, resolve, reject) {
        if (this.dispatcher.indexOf(type) == -1) {
            this.dispatcher[this.dispatcher.length] = type;
        }
        if (typeof type == 'string') {
            if (type in this.entries) {
                if (this.entries[type] instanceof Array) {
                    this.entries[type].map((entry) => {
                        if (entry instanceof Function) {
                            this.returned = SensenEmitter.resolveDispatcher({
                                instance: this,
                                type,
                                callback: entry,
                                args,
                                resolve,
                                reject,
                            });
                        }
                    });
                }
            }
        }
        return this;
    }
    static resolveDispatcher({ instance, type, args, callback, resolve, reject, }) {
        const $args = {
            emit: args,
            type,
        };
        const applied = callback.apply(instance, [$args]);
        /**
         * Promise
         */
        if (applied instanceof Promise) {
            return applied.then(response => {
                if (typeof resolve == 'function') {
                    resolve(EmitterResponse(type, response));
                }
            }).catch(err => {
                if (typeof reject == 'function') {
                    reject(err);
                }
            });
        }
        else if (typeof applied == 'boolean') {
            return applied;
        }
        else {
            return this;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1pdHRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImVtaXR0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUE7O0dBRUc7QUFnREg7O0dBRUc7QUFDSCxNQUFNLFVBQVUsZUFBZSxDQUFJLElBQVksRUFBRSxJQUFTO0lBRXRELE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUE7QUFFekIsQ0FBQztBQU1EOztHQUVHO0FBQ0YsTUFBTSxPQUFPLGFBQWE7SUFpQnZCO1FBRUksSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFFbEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7UUFFbkIsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7SUFFekIsQ0FBQztJQU1EOztPQUVHO0lBQ0gsTUFBTSxDQUFJLElBQXdCLEVBQUUsUUFBbUM7UUFFbkUsSUFBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBQztZQUVqQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDO1NBRTlDO1FBRUQsSUFBRyxPQUFPLElBQUksSUFBSSxRQUFRLElBQUksT0FBTyxRQUFRLElBQUksVUFBVSxFQUFDO1lBRXhELElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBRSxFQUFFLENBQUM7WUFFNUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7U0FFckM7UUFFRCxPQUFPLElBQUksQ0FBQztJQUVoQixDQUFDO0lBTUQ7O09BRUc7SUFDSCxRQUFRLENBRUosSUFBd0IsRUFFeEIsSUFBUyxFQUVULE9BQW1DLEVBRW5DLE1BQXFEO1FBS3JELElBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUM7WUFFbkMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQztTQUVsRDtRQUdELElBQUcsT0FBTyxJQUFJLElBQUksUUFBUSxFQUFDO1lBRXZCLElBQUcsSUFBSSxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUM7Z0JBRXBCLElBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsWUFBWSxLQUFLLEVBQUM7b0JBRW5DLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFDLEVBQUU7d0JBRTVCLElBQUcsS0FBSyxZQUFZLFFBQVEsRUFBQzs0QkFFekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxhQUFhLENBQUMsaUJBQWlCLENBQUk7Z0NBRS9DLFFBQVEsRUFBRyxJQUFJO2dDQUVmLElBQUk7Z0NBRUosUUFBUSxFQUFFLEtBQUs7Z0NBRWYsSUFBSTtnQ0FFSixPQUFPO2dDQUVQLE1BQU07NkJBRVQsQ0FBQyxDQUFBO3lCQUVMO29CQUVMLENBQUMsQ0FBQyxDQUFDO2lCQUVOO2FBRUo7U0FFSjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBRWhCLENBQUM7SUFNRCxNQUFNLENBQUMsaUJBQWlCLENBQUksRUFFeEIsUUFBUSxFQUVSLElBQUksRUFFSixJQUFJLEVBRUosUUFBUSxFQUVSLE9BQU8sRUFFUCxNQUFNLEdBRW1CO1FBRXpCLE1BQU0sS0FBSyxHQUErQjtZQUV0QyxJQUFJLEVBQUUsSUFBSTtZQUVWLElBQUk7U0FFUCxDQUFBO1FBRUQsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBR2xEOztXQUVHO1FBQ0gsSUFBRyxPQUFPLFlBQVksT0FBTyxFQUFDO1lBRTFCLE9BQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUEsRUFBRTtnQkFFMUIsSUFBRyxPQUFPLE9BQU8sSUFBSSxVQUFVLEVBQUM7b0JBRTVCLE9BQU8sQ0FBRSxlQUFlLENBQUksSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFFLENBQUE7aUJBRWhEO1lBRUwsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQSxFQUFFO2dCQUVWLElBQUcsT0FBTyxNQUFNLElBQUksVUFBVSxFQUFDO29CQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtpQkFBRTtZQUVsRCxDQUFDLENBQUMsQ0FBQztTQUdOO2FBRUksSUFBRyxPQUFPLE9BQU8sSUFBSSxTQUFTLEVBQUM7WUFFaEMsT0FBTyxPQUFPLENBQUM7U0FFbEI7YUFFRztZQUVBLE9BQU8sSUFBSSxDQUFDO1NBRWY7SUFFTCxDQUFDO0NBTUoiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuLyoqXG4gKiBUeXBlXG4gKi9cblxuZXhwb3J0IHR5cGUgU2Vuc2VuRW1pdHRlclR5cGUgPSBzdHJpbmdcblxuZXhwb3J0IHR5cGUgU2Vuc2VuRW1pdHRlckFyZ3VtZW50czxUPiA9IHtcbiAgICBcbiAgICBlbWl0OiBUO1xuICAgIFxuICAgIHR5cGUgOiBzdHJpbmc7XG4gICAgXG59XG5cbmV4cG9ydCB0eXBlIFNlbnNlbkVtaXR0ZXJDYWxsYmFjazxUPiA9ICgoYXJnOiBTZW5zZW5FbWl0dGVyQXJndW1lbnRzPFQ+KSA9PiBQcm9taXNlPCBUIHwgU2Vuc2VuRW1pdHRlckFyZ3VtZW50czxUPiA+IHwgYm9vbGVhbiB8IHZvaWQpXG5cbmV4cG9ydCB0eXBlIFNlbnNlbkVtaXR0ZXJFcnJvciA9IHtcbiAgICBjb2RlOiBudW1iZXI7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xufVxuXG5leHBvcnQgdHlwZSBTZW5zZW5FbWl0dGVyRXJyb3JDYWxsYmFjayA9ICgoYXJnOiBTZW5zZW5FbWl0dGVyRXJyb3IpID0+IHZvaWQpXG5cbmV4cG9ydCB0eXBlIFNlbnNlbkVtaXR0ZXJFbnRyaWVzID0ge1xuXG4gICAgW0s6IFNlbnNlbkVtaXR0ZXJUeXBlXSA6IFNlbnNlbkVtaXR0ZXJDYWxsYmFjazxhbnk+W10gXG5cbn1cblxuZXhwb3J0IHR5cGUgRW1pdHRlckRpc3BhdGNoZXJQcm9wczxUPiA9IHtcbiAgICAgICAgXG4gICAgaW5zdGFuY2UgOiBTZW5zZW5FbWl0dGVyLCBcbiAgICBcbiAgICB0eXBlIDogU2Vuc2VuRW1pdHRlclR5cGUsIFxuICAgIFxuICAgIGFyZ3M6IGFueSxcbiAgICBcbiAgICBjYWxsYmFjazogU2Vuc2VuRW1pdHRlckNhbGxiYWNrPFQ+LFxuICAgIFxuICAgIHJlc29sdmU/IDogU2Vuc2VuRW1pdHRlckNhbGxiYWNrPFQ+LFxuICAgIFxuICAgIHJlamVjdD8gOiAoZXJyIDogU2Vuc2VuRW1pdHRlckVycm9yQ2FsbGJhY2sgKSA9PiB2b2lkLFxuXG59XG5cblxuXG5cblxuXG4vKipcbiAqIFNlbnNlbiBFdmVudCBFbWl0dGVyIFJlc3BvbnNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBFbWl0dGVyUmVzcG9uc2U8VD4odHlwZTogc3RyaW5nLCBlbWl0OiBhbnkpIDogU2Vuc2VuRW1pdHRlckFyZ3VtZW50czxUPntcblxuICAgIHJldHVybiB7IHR5cGUsIGVtaXQgfVxuICAgIFxufVxuXG5cblxuXG5cbi8qKlxuICogU2Vuc2VuIEV2ZW50IEVtaXR0ZXJcbiAqL1xuIGV4cG9ydCBjbGFzcyBTZW5zZW5FbWl0dGVye1xuXG5cbiAgICBlbnRyaWVzOiBTZW5zZW5FbWl0dGVyRW50cmllc1xuXG4gICAgbGlzdGVuZXI6IFNlbnNlbkVtaXR0ZXJUeXBlW11cblxuICAgIGRpc3BhdGNoZXI6IFNlbnNlbkVtaXR0ZXJUeXBlW11cblxuXG4gICAgcmV0dXJuZWQ/OiBhbnlcbiAgICAgXG5cblxuXG4gICAgXG5cbiAgICBjb25zdHJ1Y3Rvcigpe1xuXG4gICAgICAgIHRoaXMuZW50cmllcyA9IHt9O1xuXG4gICAgICAgIHRoaXMubGlzdGVuZXIgPSBbXTtcblxuICAgICAgICB0aGlzLmRpc3BhdGNoZXIgPSBbXTtcbiAgICAgICAgICAgIFxuICAgIH1cblxuXG5cblxuXG4gICAgLyoqXG4gICAgICogTGlzdGVuZXJcbiAgICAgKi9cbiAgICBsaXN0ZW48VD4odHlwZSA6IFNlbnNlbkVtaXR0ZXJUeXBlLCBjYWxsYmFjayA6IFNlbnNlbkVtaXR0ZXJDYWxsYmFjazxUPil7XG5cbiAgICAgICAgaWYodGhpcy5saXN0ZW5lci5pbmRleE9mKHR5cGUpID09IC0xKXtcblxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lclt0aGlzLmxpc3RlbmVyLmxlbmd0aF0gPSB0eXBlO1xuXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmKHR5cGVvZiB0eXBlID09ICdzdHJpbmcnICYmIHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nKXtcblxuICAgICAgICAgICAgdGhpcy5lbnRyaWVzW3R5cGVdID0gdGhpcy5lbnRyaWVzW3R5cGVdfHxbXTtcblxuICAgICAgICAgICAgdGhpcy5lbnRyaWVzW3R5cGVdLnB1c2goY2FsbGJhY2spO1xuXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgXG4gICAgfVxuXG5cblxuXG5cbiAgICAvKipcbiAgICAgKiBEaXNwYXRjaGVyXG4gICAgICovXG4gICAgZGlzcGF0Y2g8VD4oXG4gICAgICAgIFxuICAgICAgICB0eXBlIDogU2Vuc2VuRW1pdHRlclR5cGUsXG4gICAgICAgIFxuICAgICAgICBhcmdzIDoge30sIFxuICAgICAgICBcbiAgICAgICAgcmVzb2x2ZT8gOiBTZW5zZW5FbWl0dGVyQ2FsbGJhY2s8VD4sXG4gICAgICAgIFxuICAgICAgICByZWplY3Q/IDogKGVyciA6IFNlbnNlbkVtaXR0ZXJFcnJvckNhbGxiYWNrICkgPT4gdm9pZFxuXG4gICAgKXtcbiAgICAgICAgXG5cbiAgICAgICAgaWYodGhpcy5kaXNwYXRjaGVyLmluZGV4T2YodHlwZSkgPT0gLTEpe1xuXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoZXJbdGhpcy5kaXNwYXRjaGVyLmxlbmd0aF0gPSB0eXBlO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICBpZih0eXBlb2YgdHlwZSA9PSAnc3RyaW5nJyl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKHR5cGUgaW4gdGhpcy5lbnRyaWVzKXtcblxuICAgICAgICAgICAgICAgIGlmKHRoaXMuZW50cmllc1t0eXBlXSBpbnN0YW5jZW9mIEFycmF5KXtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVudHJpZXNbdHlwZV0ubWFwKChlbnRyeSk9PntcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZW50cnkgaW5zdGFuY2VvZiBGdW5jdGlvbil7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJldHVybmVkID0gU2Vuc2VuRW1pdHRlci5yZXNvbHZlRGlzcGF0Y2hlcjxUPih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA6IHRoaXMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZW50cnksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgfVxuXG5cblxuXG5cbiAgICBzdGF0aWMgcmVzb2x2ZURpc3BhdGNoZXI8VD4oe1xuICAgICAgICBcbiAgICAgICAgaW5zdGFuY2UsIFxuICAgICAgICBcbiAgICAgICAgdHlwZSwgXG4gICAgICAgIFxuICAgICAgICBhcmdzLFxuICAgICAgICBcbiAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgIFxuICAgICAgICByZXNvbHZlLFxuICAgICAgICBcbiAgICAgICAgcmVqZWN0LFxuXG4gICAgfSA6IEVtaXR0ZXJEaXNwYXRjaGVyUHJvcHM8VD4pe1xuXG4gICAgICAgIGNvbnN0ICRhcmdzIDogU2Vuc2VuRW1pdHRlckFyZ3VtZW50czxUPiA9IHtcblxuICAgICAgICAgICAgZW1pdDogYXJncyxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdHlwZSxcblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYXBwbGllZCA9IGNhbGxiYWNrLmFwcGx5KGluc3RhbmNlLCBbJGFyZ3NdKTtcblxuICAgIFxuICAgICAgICAvKipcbiAgICAgICAgICogUHJvbWlzZVxuICAgICAgICAgKi9cbiAgICAgICAgaWYoYXBwbGllZCBpbnN0YW5jZW9mIFByb21pc2Upe1xuXG4gICAgICAgICAgICByZXR1cm4gYXBwbGllZC50aGVuKHJlc3BvbnNlPT57XG5cbiAgICAgICAgICAgICAgICBpZih0eXBlb2YgcmVzb2x2ZSA9PSAnZnVuY3Rpb24nKXsgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCBFbWl0dGVyUmVzcG9uc2U8VD4odHlwZSwgcmVzcG9uc2UpICkgXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pLmNhdGNoKGVycj0+e1xuXG4gICAgICAgICAgICAgICAgaWYodHlwZW9mIHJlamVjdCA9PSAnZnVuY3Rpb24nKXsgcmVqZWN0KGVycikgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIGlmKHR5cGVvZiBhcHBsaWVkID09ICdib29sZWFuJyl7XG5cbiAgICAgICAgICAgIHJldHVybiBhcHBsaWVkO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBlbHNle1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgfVxuICAgIFxuICAgIFxuICAgIFxuXG4gICAgXG59XG4iXX0=